<!doctype html>
<html lang="kr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <h1>로그인테스트</h1>
    <!-- 로컬 -->
    <div>
      <label for="id">아이디</label>
      <input type="text" id="id" name="id" required />
    </div>
    <div>
      <label for="pw">비밀번호</label>
      <input type="password" id="pw" name="pw" required />
    </div>
    <button onclick="requestLocal()">로그인</button>
    <!-- 네이버-->
    <input type="button" value="네이버 로그인" onclick="requestNaver()" />
    <!-- 구글 -->
    <button onclick="requestGoogle()">구글 로그인</button>
    <!-- 파일 첨부 -->
    </div>
    <form action="/mypages/profile" method="post" enctype="multipart/form-data">
      <input type="file" id="inputFile" name="profile" />
      <button type="submit" >올리기</button>
    </form>
  </body>
<!-- onclick="requestFile()" -->
    <script>
      const file = document.getElementById('inputFile');


      const requestLocal = async () => {
        const idValue = document.getElementById('id').value;
        const pwValue = document.getElementById('pw').value;

        const resposne = await fetch('/users/login/local', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            id: idValue,
            pw: pwValue
          })
        });
        //const result  = await response.json() // 이게 res.status(200).send()// 빈 {} 오브젝트 지워주세요 쓰고 안쓰고의 차이가 커
        // 보내주는 값이 없는데 json으로 바꿀수없으므로 에러가 남.
        // 그래서 api 명세서 정확하게 써줘야해.
      };

      const requestNaver = async () => {
        const NaverResponse = await fetch('/users/login/naver', {
          method: 'POST'
        });

        const naverLoginWindow = await NaverResponse.text();
        window.location.href = naverLoginWindow;
      };

      const requestFile = async () => {
        const profileResponse = await fetch('/mypages/profile', {
          method: 'POST'
        });
      };
    </script>
  </body>
</html>
